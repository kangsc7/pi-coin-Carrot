# 파이코인 마켓 🥕 π-coin Market

## 프로젝트 개요
- **이름**: 파이코인 마켓 (Pi-coin Market)
- **목표**: 당근마켓을 벤치마킹한 파이코인 기반 중고거래 플랫폼
- **핵심 기능**: 파이코인 거래, 1:1 채팅, 안전한 개인간 거래, 실시간 관리자 문의

## 🔗 접속 URL
- **개발 서버**: https://3000-itazdxkuanbpbbhpfsnhl-6532622b.e2b.dev
- **공지사항 페이지**: https://3000-itazdxkuanbpbbhpfsnhl-6532622b.e2b.dev/static/notice
- **API 헬스체크**: https://3000-itazdxkuanbpbbhpfsnhl-6532622b.e2b.dev/api/health
- **GitHub**: (향후 배포 예정)

---

## ✨ 완성된 주요 기능들

### 🏷️ **1. 파이코인 마켓 브랜딩**
- **π 심볼 로고**: 파이코인을 상징하는 오렌지 그라데이션 로고
- **당근마켓 UI**: 친근하고 직관적인 사용자 인터페이스
- **파이코인 특화**: π-coin 잔액, 이중 가격 표시 시스템

### 👤 **2. 사용자 인증 & 프로필**
- **간편 회원가입**: 이름, 사용자명, 이메일, 전화번호
- **가입 축하 선물**: π-coin 50개 자동 지급!
- **사용자 프로필**: 자기소개, 위치, 거래 평점, 리뷰 시스템
- **보안**: 이메일/사용자명 중복 확인

### 💬 **3. 1:1 채팅 시스템**
- **실시간 채팅**: 구매자-판매자 직접 소통
- **3일 자동 삭제**: 채팅 기록이 3일 경과시 자동 삭제
- **⚠️ 주의 문구**: "채팅 기록은 3일이 경과하면 자동으로 삭제됩니다"

### 📦 **4. 상품 등록 시스템**
- **세련된 양식**: 카테고리, 상태, 위치, 가격 설정
- **이미지 업로드**: 최대 3장, 80% 품질 JPG 자동 압축
- **1일 3개 제한**: 게시물 수 제한, 삭제시 카운트 복구 가능
- **거래 완료**: 1달 후 자동 삭제 (⚠️ 주의 문구 포함)

### 🪙 **5. π-coin 구매 시스템**
- **구매 패키지**: 1,000개=1,000원, 10,000개=10,000원 등
- **보너스 시스템**: 대량 구매시 보너스 π-coin 제공
- **결제 방식**: 신용카드, 무통장입금, 간편결제 지원
- **즉시 충전**: 구매 완료 즉시 계정 잔액 반영

### 🛡️ **6. 관리자 시스템**
- **관리자 대시보드**: 통계, 상품관리, 사용자관리
- **상품 검색/관리**: 날짜, 이메일, 사용자명으로 검색
- **상품 제재**: 숨기기, 삭제 기능 (사유 기록)
- **π-coin 판매 관리**: 구매 내역 및 통계 확인
- **📢 공지사항 관리**: 작성, 수정, 삭제 기능 (관리자 전용)

### 💬 **7. 실시간 고객 문의**
- **고정 문의 버튼**: 페이지 이동시에도 따라다니는 문의 버튼
- **실시간 채팅**: 관리자와 실시간 1:1 채팅
- **자동 응답**: 관리자 부재시 자동 응답 시스템
- **3일 자동 삭제**: 문의 채팅도 3일 후 자동 삭제

### 🔍 **8. 고급 검색 & 필터링 시스템** ⭐ **NEW!**
- **🎨 향상된 상품 상태 배지**: 새상품, 거의새것, 좋음, 보통, 나쁨 - 그라데이션 배경색과 반투명 효과로 가독성 대폭 향상
- **🔍 고급 검색 필터**: 상품명, 카테고리, 지역, 상품 상태, 가격대를 동시에 필터링 가능
- **💰 스마트 가격 필터**: 빠른 선택 프리셋 (1만원 이하 ~ 100만원 이상) + 사용자 정의 가격 범위 입력
- **📍 지역별 필터링**: 전국 17개 시/도별 상세 지역 필터링
- **⭐ 상품 상태 다중 선택**: 여러 상품 상태를 동시에 선택하여 검색 가능
- **🏷️ 활성 필터 표시**: 현재 적용중인 필터들을 태그 형태로 표시, 개별 제거 가능
- **⚡ 실시간 검색**: 500ms 디바운스 적용으로 부드러운 실시간 검색 경험
- **🎯 원클릭 초기화**: 모든 필터를 한번에 초기화하는 편리한 기능

### 🔍 **9. 기존 스마트 기능들**
- **카테고리 분류**: 8개 주요 카테고리 체계적 관리
- **검색 & 정렬**: 최신순, 가격순, 인기순, 키워드 검색
- **좋아요 시스템**: 관심 상품 위시리스트 저장
- **조회수 추적**: 상품 인기도 측정 및 통계
- **인기 검색어**: 실시간 인기 검색어 추적
- **안전 거래 팁**: 거래 안전을 위한 가이드라인

---

## 📋 API 엔드포인트

### **인증 관련**
- `POST /api/auth/signup` - 회원가입
- `POST /api/auth/login` - 로그인

### **상품 관련**
- `GET /api/products` - 상품 목록 조회
  - **새로운 필터링 파라미터** ⭐:
    - `search`: 상품명 검색
    - `category`: 카테고리 ID
    - `location`: 지역 필터링
    - `conditions`: 다중 상품 상태 (콤마 구분, 예: "new,like_new,good")
    - `minPrice`: 최저 가격
    - `maxPrice`: 최고 가격
    - `sort`: 정렬 방식 (latest/price_low/price_high/popular)
- `POST /api/products` - 상품 등록
- `GET /api/products/:id` - 상품 상세 조회
- `DELETE /api/products/:id` - 상품 삭제
- `POST /api/products/:id/like` - 상품 좋아요
- `POST /api/products/:id/complete` - 거래 완료

### **채팅 관련**
- `POST /api/chat/room` - 채팅방 생성/조회
- `POST /api/chat/message` - 채팅 메시지 전송
- `GET /api/chat/:roomId/messages` - 채팅 메시지 목록
- `GET /api/user/:userId/chatrooms` - 사용자 채팅방 목록

### **π-coin 관련**
- `GET /api/pi-coin/packages` - 구매 패키지 조회
- `POST /api/pi-coin/purchase` - π-coin 구매
- `GET /api/user/:userId/purchases` - 구매 이력 조회

### **관리자 관련**
- `GET /api/admin/dashboard/stats` - 대시보드 통계
- `GET /api/admin/products/search` - 관리자 상품 검색
- `POST /api/admin/products/:id/action` - 상품 제재 (숨기기/삭제)

### **공지사항 관리**
- `GET /api/notices` - 공지사항 목록 조회
- `GET /api/notices/:id` - 공지사항 상세 조회
- `POST /api/notices` - 공지사항 작성 (관리자만)
- `PUT /api/notices/:id` - 공지사항 수정 (관리자만)
- `DELETE /api/notices/:id` - 공지사항 삭제 (관리자만)

### **관리자 문의**
- `POST /api/admin/chat/room` - 관리자 문의방 생성
- `POST /api/admin/chat/message` - 관리자 문의 메시지
- `GET /api/admin/chat/:roomId/messages` - 관리자 문의 내역

### **시스템**
- `POST /api/cleanup/expired` - 만료된 데이터 정리 (크론용)
- `GET /api/health` - 헬스체크

---

## 🗃️ 데이터베이스 구조

### **핵심 테이블**
- **users**: 사용자 정보 (프로필, π-coin 잔액, 평점, 관리자 권한)
- **categories**: 상품 카테고리 (8개 주요 카테고리)
- **products**: 상품 정보 (원화/π-coin 가격, 자동삭제 시간)
- **product_images**: 상품 이미지 (최대 3장)
- **chat_rooms**: 1:1 채팅방
- **chat_messages**: 채팅 메시지 (3일 후 자동 삭제)
- **daily_post_count**: 1일 게시물 제한 관리

### **π-coin 시스템**
- **pi_coin_packages**: 구매 패키지 정보
- **pi_coin_purchases**: π-coin 구매 이력
- **transactions**: 거래 내역 추적

### **관리자 시스템**
- **admin_chat_rooms**: 관리자 문의 채팅방
- **admin_chat_messages**: 관리자 문의 메시지 (3일 자동 삭제)
- **admin_actions**: 관리자 액션 로그
- **reports**: 신고 시스템

### **공지사항 시스템**
- **notices**: 공지사항 정보 (제목, 내용, 카테고리, 고정 여부)

### **추가 기능**
- **user_likes**: 위시리스트 (좋아요)
- **user_reviews**: 사용자 리뷰/평가 시스템
- **notifications**: 알림 시스템
- **safety_tips**: 안전 거래 가이드
- **faqs**: 자주 묻는 질문

### **저장소 서비스**
- **Cloudflare D1**: SQLite 기반 관계형 데이터베이스
- **로컬 개발**: .wrangler/state/v3/d1 (자동 생성)

---

## 🎯 사용자 가이드

### **회원가입 & π-coin 충전**
1. **회원가입** → π-coin 50개 자동 지급
2. **π-coin 구매** → 1,000개=1,000원부터 대량 패키지까지
3. **보너스 혜택** → 대량 구매시 추가 π-coin 제공

### **상품 거래**
1. **상품 등록** → 하루 최대 3개 등록 가능
2. **이미지 업로드** → 최대 3장, 자동 80% 압축
3. **🔍 스마트 검색** ⭐ → 고급 필터링으로 원하는 상품 빠르게 찾기
   - **상품명 검색** → 실시간 검색 (500ms 디바운스)
   - **지역 필터링** → 17개 시/도 세부 지역 선택
   - **상품 상태** → 새상품/거의새것/좋음/보통/나쁨 다중 선택
   - **가격대 설정** → 프리셋 선택 또는 직접 입력
4. **채팅 협상** → 실시간 1:1 채팅으로 거래 협상
5. **안전 거래** → CCTV 설치된 공공장소에서 만남
6. **거래 완료** → π-coin으로 결제 후 거래 완료 처리

### **관리자 문의**
1. **문의 버튼** → 우측 하단 고정 버튼 클릭
2. **실시간 채팅** → 관리자와 직접 소통
3. **빠른 응답** → 평균 10분 내 답변
4. **자동 삭제** → 문의 내역도 3일 후 자동 삭제

---

## ⚠️ 중요 안내사항

### **데이터 자동 삭제**
- **채팅 기록**: 3일이 경과하면 자동으로 삭제됩니다
- **거래 완료 게시글**: 1달 후 자동으로 삭제됩니다
- **관리자 문의**: 3일 후 자동으로 삭제됩니다
- **중요한 내용은 별도로 메모해 주세요**

### **게시물 제한**
- **1일 최대 3개**: 하루에 최대 3개의 상품만 등록 가능
- **삭제시 복구**: 게시물 삭제하면 당일 등록 가능 개수 복구
- **이미지 제한**: 상품당 최대 3장까지 업로드 가능

### **π-coin 시스템**
- **가상 화폐**: 파이코인 마켓 전용 가상 화폐
- **1:1 비율**: π-coin 1개 = 1원 
- **즉시 충전**: 구매 완료 즉시 계정 반영
- **환불 제한**: 가상화폐 특성상 환불 제한

---

## 🛠️ 기술 스택

### **Backend**
- **Hono Framework**: 경량 고성능 웹 프레임워크
- **TypeScript**: 타입 안전성
- **Cloudflare D1**: 글로벌 분산 SQLite 데이터베이스

### **Frontend**
- **HTML5**: 시멘틱 마크업
- **TailwindCSS**: 유틸리티 우선 CSS 프레임워크
- **Vanilla JavaScript**: 순수 자바스크립트 (프레임워크 없음)
- **FontAwesome**: 아이콘 시스템
- **Axios**: HTTP 클라이언트

### **배포 & 인프라**
- **Cloudflare Pages**: 정적 사이트 호스팅
- **Cloudflare Workers**: 서버리스 백엔드
- **PM2**: 프로세스 관리 (개발환경)

---

## 🚀 개발 환경 설정

### **로컬 실행**
```bash
# 의존성 설치
npm install

# 데이터베이스 초기화 및 시드 데이터
npm run db:reset
npx wrangler d1 execute picoin-market-production --local --file=./seed_admin.sql
npx wrangler d1 execute picoin-market-production --local --file=./seed_additional.sql

# 프로젝트 빌드
npm run build

# 개발 서버 시작 (PM2 사용)
pm2 start ecosystem.config.cjs
```

### **유용한 명령어**
```bash
# 데이터베이스 관리
npm run db:migrate:local    # 로컬 DB 마이그레이션
npm run db:seed             # 시드 데이터 삽입
npm run db:console:local    # 로컬 DB 콘솔
npm run db:reset            # DB 초기화 및 재구성

# 서비스 관리
npm run test               # 서비스 테스트
npm run clean-port         # 포트 3000 정리
pm2 logs --nostream        # 로그 확인
pm2 restart picoin-market  # 서비스 재시작

# Git 관리
npm run git:status         # Git 상태 확인
npm run git:commit "메시지" # 커밋
npm run git:log            # 커밋 로그
```

---

## 👨‍💻 관리자 정보

### **관리자 계정**
- **이메일**: 5321497@naver.com
- **비밀번호**: alfo1497@@
- **권한**: 전체 시스템 관리, 상품 제재, 사용자 관리, 통계 확인

### **관리자 기능**
- **대시보드**: 실시간 통계 및 현황 모니터링
- **상품 관리**: 검색, 숨김, 삭제 등 제재 기능
- **고객 문의**: 실시간 채팅을 통한 고객 지원
- **π-coin 관리**: 구매 내역 및 판매 통계 관리

---

## 📊 현재 상태

### **✅ 완성된 기능들**
- [x] 사용자 인증 시스템 (회원가입/로그인)
- [x] π-coin 구매 시스템 (4개 패키지)
- [x] 상품 등록/조회/삭제 시스템
- [x] **🔍 고급 필터링 시스템** ⭐ (상품명/카테고리/지역/상태/가격 다중 필터링)
- [x] **🎨 향상된 UI/UX** ⭐ (상품 상태 배지 가독성 대폭 개선)
- [x] 1:1 채팅 시스템 (3일 자동 삭제)
- [x] 관리자 대시보드 및 관리 기능
- [x] **📢 공지사항 관리 시스템** (작성/수정/삭제/편집 기능)
- [x] 실시간 고객 문의 시스템
- [x] 거래 완료 상품 1달 후 자동 삭제
- [x] 안전 거래 가이드 및 FAQ
- [x] 사용자 프로필 및 평점 시스템
- [x] 위시리스트 (좋아요) 기능

### **✅ 최신 업데이트 (2025-09-12)** ⭐
- [x] **고급 필터링 시스템** - 상품명, 카테고리, 지역, 상품 상태, 가격대 다중 필터링
- [x] **향상된 상품 상태 배지** - 그라데이션 배경, 반투명 효과, 텍스트 그림자로 가독성 대폭 향상
- [x] **스마트 가격 필터** - 빠른 선택 프리셋 + 사용자 정의 범위 입력
- [x] **활성 필터 표시** - 현재 적용된 필터를 태그 형태로 표시, 개별 제거 가능
- [x] **실시간 검색** - 500ms 디바운스로 부드러운 사용자 경험
- [x] **다중 상품 상태 선택** - 여러 상품 상태를 동시에 필터링 가능
- [x] **백엔드 API 확장** - 새로운 필터링 파라미터 지원

### **🔄 준비중인 기능들**
- [ ] 신고 시스템 완전 구현
- [ ] 사용자 리뷰 상세 페이지
- [ ] 실제 이미지 업로드 (현재는 데모 URL)
- [ ] 웹소켓 실시간 채팅 (현재는 폴링)
- [ ] 푸시 알림 시스템

---

## 📈 통계 및 성과

- **개발 기간**: 1일 집중 개발 + 고급 필터링 시스템 업데이트
- **코드 라인**: 약 16,000+ 라인 (필터링 시스템 추가)
- **API 엔드포인트**: 20+ 개 (확장된 필터링 파라미터)
- **데이터베이스 테이블**: 25+ 개
- **주요 기능**: 모든 핵심 기능 완성 + 고급 검색 시스템 ✅
- **UI/UX 개선**: 상품 상태 배지 가독성 대폭 향상 ⭐

---

**🥕 파이코인으로 더 안전하고 특별한 거래를 경험하세요! ✨**

*"당근마켓의 편리함과 파이코인의 혁신이 만나 탄생한 새로운 중고거래 플랫폼"*